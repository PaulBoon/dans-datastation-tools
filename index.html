<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>dans-datastation-tools</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Manual";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> dans-datastation-tools
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href=".">Manual</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#synopsis">SYNOPSIS</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#description">DESCRIPTION</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#batch-processing-of-datasets">Batch processing of datasets</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#examples">EXAMPLES</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#processing-json-output-of-dans-bag-validate-with-jq">Processing JSON output of dans-bag-validate with jq</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#installation-configuration">INSTALLATION &amp; CONFIGURATION</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#for-the-current-user">For the current user</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#globally">Globally</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="dev/">Development</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="arch/">â‡’ DANS Data Station Architecture</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">dans-datastation-tools</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li><li>Manual</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/DANS-KNAW/dans-datastation-tools/edit/master/docs/index.md"> Edit on DANS-KNAW/dans-datastation-tools</a>
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="dans-datastation-tools">dans-datastation-tools<a class="headerlink" href="#dans-datastation-tools" title="Permanent link">&para;</a></h1>
<p>Command line utilities for Data Station application management</p>
<h2 id="synopsis">SYNOPSIS<a class="headerlink" href="#synopsis" title="Permanent link">&para;</a></h2>
<pre><code class="language-bash">pip3 install dans-datastation-tools

# To find out what a command does, use &lt;command&gt; --help, e.g.:
# dans-bag-validate --help

# Below is a partial list of commands. Commands are grouped by the application they target. 
# Commands in a group have the same prefix so you can use command line completion to find 
# all commands in a group. For example, to find all commands targeting Dataverse, 
# type `dv-` and press the tab key twice. This will list all commands starting with `dv-`.
# Some commands have subcommands, you can find the subcommands with the --help option.

# DANS bag validation
dans-bag-validate

# Commands targeting Dataverse start with dv-, e.g.:

# Dataverse banner management
dv-banner 

# Commands targeting Dataverse datasets start with dv-dataset-, e.g.:
dv-dataset-delete-draft 
dv-dataset-destroy
dv-dataset-destroy-migration-placeholder  
dv-dataset-find-by-role-assignment

# Dataverse user management
dv-user-import

# Ingest flow management
ingest-flow
</code></pre>
<h2 id="description">DESCRIPTION<a class="headerlink" href="#description" title="Permanent link">&para;</a></h2>
<p>This module contains a variety of commands to facilitate DANS Data Station management. To find out what a command does,
use <code>&lt;command&gt; --help</code>. See the comments in the SYNOPSIS section above to get an idea of what commands are available.</p>
<h3 id="batch-processing-of-datasets">Batch processing of datasets<a class="headerlink" href="#batch-processing-of-datasets" title="Permanent link">&para;</a></h3>
<p>Some of the commands targeting Dataverse datasets can be used to process a large number of datasets in a batch. These
commands take a trailing argument <code>pid_or_pids_file</code>. As the name suggests, this argument can be either a single PID or
a file containing a list of PIDs. The file should contain one PID per line. These commands usually have the following
options:</p>
<ul>
<li><code>--wait-between-items</code>: the number of seconds to wait between processing each dataset. This is useful to avoid
  overloading the server.</li>
<li><code>--fail-fast</code>: fail on the first error. If this option is not given, the command will continue processing the
  remaining datasets after an error has occurred.</li>
<li><code>--report-file</code>: the name of a CSV file in which a summary of the results will be written. The file will be created
  if it does not exist, otherwise it will be overwritten.</li>
</ul>
<h2 id="examples">EXAMPLES<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<h3 id="processing-json-output-of-dans-bag-validate-with-jq">Processing JSON output of <code>dans-bag-validate</code> with jq<a class="headerlink" href="#processing-json-output-of-dans-bag-validate-with-jq" title="Permanent link">&para;</a></h3>
<p>The JSON output of this command can be queried with <code>jq</code>. This tool has a very good
<a href="https://stedolan.github.io/jq/manual/" target="_blank">manual</a>. However, to get you started, here are some example
queries:</p>
<pre><code class="language-bash">dans-bag-validate &lt;target&gt; &gt; ~/results.json

# Print only the bag location and the violations
cat results.json 

# Count the number of bags that are non-compliant
cat results.json | jq '[.[] | select(.&quot;Is compliant&quot; == false)] | length'

# Get the paths to the *deposits* containing valid bags. Note that &quot;Bag location&quot; is one level too deep, that's why we need to remove the 
# last path element. The detour through to_entries seems necessary to get rid of the array structure around the results.
cat results.json | select(.&quot;Is compliant&quot; == true)] | map(.&quot;Bag location&quot;) | map(split(&quot;/&quot;) | .[:-1] | join(&quot;/&quot;)) | to_entries[] | &quot;\(.value)&quot;
</code></pre>
<h2 id="installation-configuration">INSTALLATION &amp; CONFIGURATION<a class="headerlink" href="#installation-configuration" title="Permanent link">&para;</a></h2>
<h3 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h3>
<h4 id="for-the-current-user">For the current user<a class="headerlink" href="#for-the-current-user" title="Permanent link">&para;</a></h4>
<p>This is the recommended way, when installing on your own machine.</p>
<pre><code class="language-bash">pip3 install --user dans-datastation-tools
</code></pre>
<p>You may have to add the directory where <code>pip3</code> installs the command to the <code>PATH</code> manually.</p>
<h4 id="globally">Globally<a class="headerlink" href="#globally" title="Permanent link">&para;</a></h4>
<p>This is useful when installing on a server where the commands need to be shared by multiple users.</p>
<pre><code class="language-bash">sudo pip3 install dans-datastation-tools
</code></pre>
<h3 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h3>
<p>The configuration file is called <code>.dans-datastation-tools.yml</code>. Each command starts by looking for this file in the
current working directory and then in the user's home directory. If it is not found in either location it is
instantiated with some default and placeholder values in the current directory. It is recommended that you move this
file to your home directory. Using the configuration file from the current working directory is mainly useful for
development.</p>
<p>For the available configuration options and their meaning, see the explanatory comments in the configuration file
itself.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="dev/" class="btn btn-neutral float-right" title="Development">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href="dev/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

<!--
MkDocs version : 1.3.0
Build Date UTC : 2024-07-23 07:33:37.899175+00:00
-->
